(this["webpackJsonpdotsama-chill"]=this["webpackJsonpdotsama-chill"]||[]).push([[0],{466:function(e){e.exports=JSON.parse('{"APP_NAME":"substrate-front-end-tutorial","DEVELOPMENT_KEYRING":true,"RPC":{}}')},502:function(e,t,n){},518:function(e){e.exports=JSON.parse('{"PROVIDER_SOCKET":"wss://dev-node.substrate.dev"}')},519:function(e){e.exports=JSON.parse("{}")},521:function(e,t){},529:function(e,t){},553:function(e,t){},555:function(e,t){},566:function(e,t){},568:function(e,t){},599:function(e,t){},600:function(e,t){},617:function(e,t){},639:function(e,t,n){},640:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(139),s=n.n(a),o=(n(502),n(2)),i=(n(682),n(666),n(684),n(677),n(667),n(664),n(503),n(16)),l=n.n(i),u=n(22),d=n(21),b=n(467),j=n(465),m=n.n(j),f=n(679),x=n(668),O=n(104),h=(n(310),n(466)),p=n(518),v=n(519),g=["REACT_APP_PROVIDER_SOCKET","REACT_APP_DEVELOPMENT_KEYRING"].reduce((function(e,t){return void 0!==Object({NODE_ENV:"production",PUBLIC_URL:"/dotsama-chill",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0})[t]&&(e[t.slice(10)]=Object({NODE_ENV:"production",PUBLIC_URL:"/dotsama-chill",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0})[t]),e}),{}),N=Object(d.a)(Object(d.a)(Object(d.a)(Object(d.a)({},h),p),g),{},{types:v}),w=n(3),C=m.a.parse(window.location.search).rpc||N.PROVIDER_SOCKET;console.log("Connected socket: ".concat(C));Object(d.a)(Object(d.a)({},b.a),N.RPC),N.types;var y=n(15);n(641);n(292),n(670),n(478),n(669),n(228),n(149);n(24),n(674);n(676),n(680);n(672);n(671),n(665);n(675);var k=n(295),S=c.a.createContext(null),E=function(e){var t=e.address,n=e.amount,c=e.idx,a=Object(r.useContext)(S),s=a.selectedNominators,o=a.setSelectedNominators,i=function(){return s.includes(t)};return Object(w.jsxs)("div",{className:"flex justify-between p-2 pr-4 border-gray-200 border items-center "+(c%2!==0?"bg-gray-100":"bg-white"),children:[Object(w.jsx)("input",{checked:i(),onChange:function(){o((function(e){return i()?e.filter((function(e){return e!==t})):[].concat(Object(y.a)(e),[t])}))},type:"checkbox",className:"w-1/12 text-left"}),Object(w.jsx)("div",{children:Object(w.jsx)("p",{className:"w-8/12 text-left self-center",children:"".concat(t.substring(0,5),"...").concat(t.substring(t.length-6,t.length-1))})}),Object(w.jsx)("p",{className:"mx-4 w-3/12 text-right",children:n})]})},A=c.a.createContext(null),T=function(e){var t=e.name,n=e.onClick,r=e.color,c=void 0===r?"#E6007A":r;return Object(w.jsx)("button",{style:{borderColor:c,backgroundColor:c},onClick:n,className:"h-full items-center border-2 py-2 px-6  h-fit text-lg text-white tracking-wider font-bold rounded-sm",children:t})},P=function(e){switch(e){case _.POLKADOT:return"wss://rpc.polkadot.io";default:throw Error("Unknown Provider ".concat(e))}},_=Object.freeze({POLKADOT:"POLKADOT"}),D=null,R=function(){var e=Object(u.a)(l.a.mark((function e(){var t,n,r,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===D){e.next=3;break}return console.log("used api instance from singleton"),e.abrupt("return",D);case 3:return t=P(_.POLKADOT),n=new f.a(t),e.next=7,x.a.create({provider:n});case 7:return r=e.sent,e.next=10,r.rpc.system.chain();case 10:return c=e.sent,console.log("Connected to node ".concat(c)),D=r,e.abrupt("return",D);case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),K=function(){var e=Object(u.a)(l.a.mark((function e(t,n,r){var c,a,s,o,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R();case 2:return c=e.sent,a=t.chillableAmount,s=r.map((function(e){return c.tx.staking.chillOther(e)})),r.length>a&&r.slice(0,a-1),e.next=8,Object(O.c)(n.meta.source);case 8:return o=e.sent,console.log("Total chillable:",s.length),console.log("Nominator"),console.log(r),console.log(s),i=c.tx.utility.batch(s),e.next=16,i.signAndSend(n.address,{signer:o.signer},(function(e){var t=e.status;t.isInBlock?console.log("\ud83d\udcc0 Transaction ".concat(i.meta.name," included at blockHash ").concat(t.asInBlock)):t.isBroadcast?console.log("\ud83d\ude80 Transaction broadcasted."):t.isFinalized?console.log("\ud83d\udcaf Transaction ".concat(i.meta.name,"(..) Finalized at blockHash ").concat(t.asFinalized)):t.isReady||console.log("\ud83e\udd37 Other status ".concat(t))}));case 16:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),B=n(476),I=n.n(B),F=function(e){Object(k.a)(e);var t=Object(r.useContext)(A).setNominators,n=Object.freeze({ASC:!1,DESC:!0}),c=Object(r.useState)(n.ASC),a=Object(o.a)(c,2),s=a[0],i=a[1];return Object(w.jsxs)("div",{className:"flex items-center ",children:[Object(w.jsx)("p",{className:"pr-2 ",children:"".concat(s===n.ASC?"ASC":"DESC")}),Object(w.jsx)(I.a,{onChange:function(e){i(e),t((function(t){var r=Object(y.a)(t);return e===n.ASC?r.sort((function(e,t){return e.amount>t.amount?1:-1})):r.sort((function(e,t){return e.amount<t.amount?1:-1})),r}))},onColor:"#E6007A",offColor:"#E6007A",checked:s,checkedIcon:!1,uncheckedIcon:!1})]})},H=(n(477),n(639),c.a.createContext(null)),L=c.a.createContext(null),V=function(){var e=Object(r.useContext)(A),t=e.nominators,n=(e.setNominators,Object(r.useContext)(S).selectedNominators),c=Object(r.useContext)(H).statistics,a=Object(r.useContext)(L).selectedAccount;return Object(w.jsxs)("div",{className:"text-lg",children:[Object(w.jsxs)("div",{className:"flex justify-between mb-2  p-4  bg-white items-center",children:[Object(w.jsxs)("p",{className:"text-2xl ",children:["Nominators (",t.length,")"]}),Object(w.jsxs)("div",{className:"flex justify-between items-center w-4/12 ",children:[Object(w.jsx)(F,{}),Object(w.jsx)(T,{onClick:function(){K(c,a,n)},name:"Chill ".concat(n.length)})]})]}),Object(w.jsxs)("div",{className:"flex items-center font-bold px-4 py-2 bg-white ",children:[Object(w.jsx)("p",{className:"w-1/12 text-left",children:"Wanna Chill ? "}),Object(w.jsx)("p",{className:"w-8/12",children:"Address"}),Object(w.jsx)("p",{className:"w-3/12 text-right  ",children:"Amount"})]})]})},W=function(){var e=Object(r.useContext)(S),t=(e.selectedNominators,e.setSelectedNominators),n=Object(r.useContext)(A).nominators;return Object(w.jsxs)("div",{className:"flex justify-between p-2 border-gray-200 border items-center bg-gray-100",children:[Object(w.jsx)("input",{onChange:function(e){return function(e){var r=e.target.checked;t((function(e){return r?Object(y.a)(n.map((function(e){return e.address}))):[]}))}(e)},type:"checkbox",className:"w-1/12 text-left"}),Object(w.jsx)("p",{className:"w-8/12 text-left self-center font-bold",children:"Chill all nominators"}),Object(w.jsx)("p",{className:"mx-4 w-3/12 text-right"})]})},q=function(){var e=Object(r.useContext)(A),t=e.nominators;e.onNominatorsFetched;return Object(w.jsxs)("div",{children:[Object(w.jsx)(V,{}),Object(w.jsx)(W,{}),t.map((function(e,t){return Object(r.createElement)(E,Object(d.a)(Object(d.a)({},e),{},{idx:t,key:e.address}))}))]})},z=function(){return Object(w.jsx)("p",{children:"Validators are being loaded "})},J=function(){var e=Object(u.a)(l.a.mark((function e(t,n,r){var c,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=n.nominatorIds,a=n.minNominatorBond,e.next=3,t.query.staking.bonded.multi(c).then(function(){var e=Object(u.a)(l.a.mark((function e(n){var c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=n.map((function(e){return e.unwrapOrDefault()})),e.next=3,t.query.staking.ledger.multi(c).then(function(){var e=Object(u.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.map((function(e){return e.unwrapOrDefault()})).filter((function(e){return e.total.toBn()<a.toNumber()})).map((function(e){var t=e.stash,n=e.total;return{address:t.toHuman(),amount:n.toHuman()}})),r(n);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),U=n(673),M=n(678),Y=n(358);function G(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter(Boolean).join(" ")}function Q(e){var t=e.selectedAccount,n=e.setSelectedAccount,c=Object(r.useState)([]),a=Object(o.a)(c,2),s=a[0],i=a[1],d=Object(r.useState)(""),b=Object(o.a)(d,2),j=b[0],m=b[1],f=function(){var e=Object(u.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(O.b)("dotsama-chill");case 2:return e.sent,e.next=5,Object(O.a)();case 5:t=e.sent,i(t),n(t[0]),h(t[0]);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),x=function(){var e=Object(u.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n(t),h(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),h=function(){var e=Object(u.a)(l.a.mark((function e(t){var n,r,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R();case 2:return n=e.sent,e.next=5,n.query.system.account(t.address);case 5:r=e.sent,c=r.data.free,m(c.toHuman());case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){f()}),[]),0===s.length?Object(w.jsx)("p",{children:"Please connect Polkadot.js Wallet"}):Object(w.jsxs)("div",{className:"flex items-center",children:[Object(w.jsx)("p",{className:"pr-4",children:j}),Object(w.jsx)(U.a,{value:t,onChange:x,children:function(e){var n=e.open;return Object(w.jsx)(w.Fragment,{children:Object(w.jsxs)("div",{className:"mt-1 relative pr-4",children:[Object(w.jsxs)(U.a.Button,{className:"relative w-full bg-white border border-gray-300 rounded-md shadow-sm pl-3 pr-10 py-2 text-left cursor-default focus:outline-none focus:ring-1 focus:ring-black focus:border-black sm:text-sm",children:[Object(w.jsx)("span",{className:"flex items-center",children:Object(w.jsx)("span",{className:"ml-3 block truncate",children:t.meta.name})}),Object(w.jsx)("span",{className:"ml-3 absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none",children:Object(w.jsx)(Y.b,{className:"h-5 w-5 text-gray-400","aria-hidden":"true"})})]}),Object(w.jsx)(M.a,{show:n,as:r.Fragment,leave:"transition ease-in duration-100",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:Object(w.jsx)(U.a.Options,{className:"absolute z-10 mt-1 w-full bg-white shadow-lg max-h-56 rounded-md py-1 text-base ring-1 ring-black ring-opacity-5 overflow-auto focus:outline-none sm:text-sm",children:s.map((function(e){return Object(w.jsx)(U.a.Option,{className:function(e){return G(e.active?"text-white bg-black":"text-gray-900","cursor-default select-none relative py-2 pl-3 pr-9")},value:e,children:function(t){var n=t.selected,r=t.active;return Object(w.jsxs)(w.Fragment,{children:[Object(w.jsx)("div",{className:"flex items-center",children:Object(w.jsx)("span",{className:G(n?"font-semibold":"font-normal","ml-3 block truncate"),children:e.meta.name})}),n?Object(w.jsx)("span",{className:G(r?"text-white":"text-black","absolute inset-y-0 right-0 flex items-center pr-4"),children:Object(w.jsx)(Y.a,{className:"h-5 w-5","aria-hidden":"true"})}):null]})}},e.address)}))})})]})})}})]})}var X=function(){var e=Object(u.a)(l.a.mark((function e(t){var n,r,c,a,s,i,u,d,b;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.query.staking.nominators.keys(),t.query.staking.minNominatorBond(),t.query.staking.maxNominatorsCount(),t.query.staking.chillThreshold()]);case 2:if(n=e.sent,r=Object(o.a)(n,4),c=r[0],a=r[1],s=r[2],i=r[3],u=c.map((function(e){return Object(o.a)(e.args,1)[0]})),d=i/100*s,b=u.length-d,!(u.length<d)){e.next=14;break}return console.log("You can't chill others when nominators (".concat(u.length,") is below threshold (").concat(d,")")),e.abrupt("return");case 14:return e.abrupt("return",{chillableAmount:b,nominatorIds:u,threshold:d,minNominatorBond:a});case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Z=function(e){var t=e.count,n=e.name,r=e.textColor;return Object(w.jsxs)("div",{children:[Object(w.jsx)("p",{className:"text-4xl pb-2 ",children:t}),Object(w.jsx)("p",{className:"text-lg text-"+r,children:n})]})},$=function(e){var t=e.first,n=e.second;return Object(w.jsxs)("div",{className:"gap-8  bg-white border-white rounded-2xl mb-4 p-12 px-16 grid grid-cols-2",children:[Object(w.jsx)(Z,Object(d.a)({},t)),Object(w.jsx)(Z,Object(d.a)({},n))]})},ee=function(e){var t=e.chillableAmount,n=e.threshold,r=e.minNominatorBond;return Object(w.jsxs)("div",{className:"flex justify-between mb-8",children:[Object(w.jsx)($,{first:{name:"Threshold",count:n,textColor:"red-500"}}),Object(w.jsx)("div",{}),Object(w.jsx)($,{first:{name:"Chillable Amount",count:t,textColor:"yellow-500"}}),Object(w.jsx)("div",{}),Object(w.jsx)($,{first:{name:"Minimum Nominator Bond",count:0===r?0:r.toHuman(),textColor:"blue-500"}})]})},te=function(e){Object(k.a)(e);var t=Object(r.useState)([]),n=Object(o.a)(t,2),c=n[0],a=n[1],s=Object(r.useState)([]),i=Object(o.a)(s,2),b=i[0],j=i[1],m=Object(r.useState)({chillableAmount:0,nominatorIds:0,threshold:0,minNominatorBond:0}),f=Object(o.a)(m,2),x=f[0],O=f[1],h=Object(r.useState)({address:null,meta:{name:null}}),p=Object(o.a)(h,2),v=p[0],g=p[1],N=Object(r.useState)(!0),C=Object(o.a)(N,2),y=C[0],E=C[1];Object(r.useEffect)((function(){T()}),[]);var T=function(){var e=Object(u.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,R(_.POLKADOT);case 2:return t=e.sent,e.next=5,X(t);case 5:n=e.sent,J(t,n,P),O(n);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),P=function(e){e.sort((function(e,t){return e.amount>t.amount?1:-1})),a(e),E(!1)};return Object(w.jsx)(A.Provider,{value:{nominators:c,setNominators:a},children:Object(w.jsx)(S.Provider,{value:{selectedNominators:b,setSelectedNominators:j},children:Object(w.jsx)(H.Provider,{value:{statistics:x},children:Object(w.jsx)(L.Provider,{value:{selectedAccount:v},children:Object(w.jsxs)("div",{className:" p-24 h-screen",style:{backgroundColor:"#f5f3f1"},children:[Object(w.jsxs)("div",{className:"flex justify-between items-start pb-6",children:[Object(w.jsx)("h1",{className:"text-4xl ",children:"dotsama-chill"}),Object(w.jsx)(Q,{selectedAccount:v,setSelectedAccount:g})]}),Object(w.jsx)("p",{className:"text-md pb-6",children:"A tool to list nominators below threshold and has the option to chill multiple nominators in a batch."}),Object(w.jsx)(ee,Object(d.a)({},x)),y?Object(w.jsx)(z,{}):Object(w.jsx)(q,{})]})})})})})};s.a.render(Object(w.jsx)(te,{}),document.getElementById("root"))}},[[640,1,2]]]);
//# sourceMappingURL=main.060549c8.chunk.js.map