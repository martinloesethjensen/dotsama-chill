(this["webpackJsonpdotsama-chill"]=this["webpackJsonpdotsama-chill"]||[]).push([[0],{119:function(e,t,n){},123:function(e,t){},133:function(e,t){},157:function(e,t,n){"use strict";n.r(t);var c=n(0),r=n.n(c),a=n(89),s=n.n(a),o=(n(119),n(28)),i=n(12),l=n.n(i),u=n(13),d=n(2),j=n(52),b=n(8),m=r.a.createContext(null),x=n(9),h=function(e){var t=e.address,n=e.amount,r=e.idx,a=Object(c.useContext)(m),s=a.selectedNominators,o=a.setSelectedNominators,i=function(){return s.includes(t)};return Object(x.jsxs)("div",{className:"flex justify-between p-2 pr-4 border-gray-200 border items-center "+(r%2!==0?"bg-gray-100":"bg-white"),children:[Object(x.jsx)("input",{checked:i(),onChange:function(){o((function(e){return i()?e.filter((function(e){return e!==t})):[].concat(Object(b.a)(e),[t])}))},type:"checkbox",className:"w-1/12 text-left"}),Object(x.jsx)("div",{children:Object(x.jsx)("p",{className:"w-8/12 text-left self-center",children:"".concat(t.substring(0,5),"...").concat(t.substring(t.length-6,t.length-1))})}),Object(x.jsx)("p",{className:"mx-4 w-3/12 text-right",children:n})]})},O=r.a.createContext(null),f=function(e){var t=e.name,n=e.onClick,c=e.color,r=void 0===c?"#E6007A":c;return Object(x.jsx)("button",{style:{borderColor:r,backgroundColor:r},onClick:n,className:"h-full items-center border-2 py-2 px-6  h-fit text-lg text-white tracking-wider font-bold rounded-sm",children:t})},p=function(e){switch(e){case v.POLKADOT:return"wss://rpc.polkadot.io";case v.KUSAMA:return"wss://kusama-rpc.polkadot.io";default:throw Error("Unknown Provider ".concat(e))}},v=Object.freeze({POLKADOT:"POLKADOT",KUSAMA:"KUSAMA"}),g=n(180),w=n(178),N=null,k=function(){var e=Object(u.a)(l.a.mark((function e(t){var n,c,r,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=p(t),c=new g.a(n),e.next=5,w.a.create({provider:c});case 5:return r=e.sent,e.next=8,r.rpc.system.chain();case 8:return a=e.sent,console.log("Connected to node ".concat(a)),N=r,e.abrupt("return",N);case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),A=n(47),y=function(){var e=Object(u.a)(l.a.mark((function e(t,n,c){var r,a,s,o,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k();case 2:return r=e.sent,a=t.chillableAmount,s=c.map((function(e){return r.tx.staking.chillOther(e)})),c.length>a&&c.slice(0,a-1),e.next=8,Object(A.c)(n.meta.source);case 8:return o=e.sent,console.log("Total chillable:",s.length),console.log("Nominator"),console.log(c),console.log(s),i=r.tx.utility.batch(s),e.next=16,i.signAndSend(n.address,{signer:o.signer},(function(e){var t=e.status;t.isInBlock?console.log("\ud83d\udcc0 Transaction ".concat(i.meta.name," included at blockHash ").concat(t.asInBlock)):t.isBroadcast?console.log("\ud83d\ude80 Transaction broadcasted."):t.isFinalized?console.log("\ud83d\udcaf Transaction ".concat(i.meta.name,"(..) Finalized at blockHash ").concat(t.asFinalized)):t.isReady||console.log("\ud83e\udd37 Other status ".concat(t))}));case 16:case"end":return e.stop()}}),e)})));return function(t,n,c){return e.apply(this,arguments)}}(),C=n(59),S=n.n(C),K=Object.freeze({POLKADOT:"#E6007A",KUSAMA:"#4E4E4E"}),P=r.a.createContext(null),L=function(e){Object(j.a)(e);var t=Object(c.useContext)(P).selectedNetwork,n=Object(c.useContext)(O).setNominators,r=Object.freeze({ASC:!1,DESC:!0}),a=Object(c.useState)(r.ASC),s=Object(d.a)(a,2),o=s[0],i=s[1],l=t===v.POLKADOT?K.POLKADOT:K.KUSAMA;return Object(x.jsxs)("div",{className:"flex items-center ",children:[Object(x.jsx)("p",{className:"pr-2 ",children:"".concat(o===r.ASC?"ASC":"DESC")}),Object(x.jsx)(S.a,{onChange:function(e){i(e),n((function(t){var n=Object(b.a)(t);return e===r.ASC?n.sort((function(e,t){return e.amount>t.amount?1:-1})):n.sort((function(e,t){return e.amount<t.amount?1:-1})),n}))},onColor:l,offColor:l,checked:o,checkedIcon:!1,uncheckedIcon:!1})]})},T=r.a.createContext(null),D=r.a.createContext(null),E=function(){var e=Object(c.useContext)(O),t=e.nominators,n=(e.setNominators,Object(c.useContext)(m).selectedNominators),r=Object(c.useContext)(T).statistics,a=Object(c.useContext)(D).selectedAccount,s=Object(c.useContext)(P).selectedNetwork===v.POLKADOT?K.POLKADOT:K.KUSAMA;return Object(x.jsxs)("div",{className:"text-lg",children:[Object(x.jsxs)("div",{className:"flex justify-between mb-2  p-4  bg-white items-center",children:[Object(x.jsxs)("p",{className:"text-2xl ",children:["Nominators (",t.length,")"]}),Object(x.jsxs)("div",{className:"flex justify-between items-center w-4/12 ",children:[Object(x.jsx)(L,{}),Object(x.jsx)(f,{onClick:function(){y(r,a,n)},name:"Chill ".concat(n.length),color:s})]})]}),Object(x.jsxs)("div",{className:"flex items-center font-bold px-4 py-2 bg-white ",children:[Object(x.jsx)("p",{className:"w-1/12 text-left",children:"Wanna Chill ? "}),Object(x.jsx)("p",{className:"w-8/12",children:"Address"}),Object(x.jsx)("p",{className:"w-3/12 text-right  ",children:"Amount"})]})]})},B=function(){var e=Object(c.useContext)(m),t=(e.selectedNominators,e.setSelectedNominators),n=Object(c.useContext)(O).nominators;return Object(x.jsxs)("div",{className:"flex justify-between p-2 border-gray-200 border items-center bg-gray-100",children:[Object(x.jsx)("input",{onChange:function(e){return function(e){var c=e.target.checked;t((function(e){return c?Object(b.a)(n.map((function(e){return e.address}))):[]}))}(e)},type:"checkbox",className:"w-1/12 text-left"}),Object(x.jsx)("p",{className:"w-8/12 text-left self-center font-bold",children:"Chill all nominators"}),Object(x.jsx)("p",{className:"mx-4 w-3/12 text-right"})]})},I=function(){var e=Object(c.useContext)(O),t=e.nominators;e.onNominatorsFetched;return Object(x.jsxs)("div",{children:[Object(x.jsx)(E,{}),Object(x.jsx)(B,{}),t.map((function(e,t){return Object(c.createElement)(h,Object(o.a)(Object(o.a)({},e),{},{idx:t,key:e.address}))}))]})},M=function(){return Object(x.jsx)("p",{children:"Nominators are being loaded..."})},U=function(){var e=Object(u.a)(l.a.mark((function e(t,n,c){var r,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.nominatorIds,a=n.minNominatorBond,e.next=3,t.query.staking.bonded.multi(r).then(function(){var e=Object(u.a)(l.a.mark((function e(n){var r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=n.map((function(e){return e.unwrapOrDefault()})),e.next=3,t.query.staking.ledger.multi(r).then(function(){var e=Object(u.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.map((function(e){return e.unwrapOrDefault()})).filter((function(e){return e.total.toBn()<a.toNumber()})).map((function(e){var t=e.stash,n=e.total;return{address:t.toHuman(),amount:n.toHuman()}})),c(n);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e)})));return function(t,n,c){return e.apply(this,arguments)}}(),F=n(179),q=n(181),z=n(74);function H(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter(Boolean).join(" ")}function J(e){var t=e.selectedAccount,n=e.setSelectedAccount,r=Object(c.useContext)(P).selectedNetwork,a=Object(c.useState)([]),s=Object(d.a)(a,2),o=s[0],i=s[1],j=Object(c.useState)(""),b=Object(d.a)(j,2),m=b[0],h=b[1],O=function(){var e=Object(u.a)(l.a.mark((function e(){var c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Fetching Accounts"),e.next=3,Object(A.b)("dotsama-chill");case 3:return e.sent,e.next=6,Object(A.a)();case 6:c=e.sent,console.log("got accounts"),i(c),n(c[0]),console.log(t),p(c[0]);case 12:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),f=function(){var e=Object(u.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n(t),p(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=Object(u.a)(l.a.mark((function e(t){var n,c,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,k(r);case 2:return n=e.sent,e.next=5,n.query.system.account(t.address);case 5:c=e.sent,a=c.data.free,h(a.toHuman());case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(c.useEffect)((function(){O()}),[]),0===o.length?Object(x.jsx)("p",{children:"Please connect Polkadot.js Wallet"}):Object(x.jsxs)("div",{className:"flex items-center",children:[Object(x.jsx)("p",{className:"pr-4",children:m}),Object(x.jsx)(F.a,{value:t,onChange:f,children:function(e){var n=e.open;return Object(x.jsx)(x.Fragment,{children:Object(x.jsxs)("div",{className:"mt-1 relative pr-4",children:[Object(x.jsxs)(F.a.Button,{className:"relative w-full bg-white border border-gray-300 rounded-md shadow-sm pl-3 pr-10 py-2 text-left cursor-default focus:outline-none focus:ring-1 focus:ring-black focus:border-black sm:text-sm",children:[Object(x.jsx)("span",{className:"flex items-center",children:Object(x.jsx)("span",{className:"ml-3 block truncate",children:t.meta.name})}),Object(x.jsx)("span",{className:"ml-3 absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none",children:Object(x.jsx)(z.b,{className:"h-5 w-5 text-gray-400","aria-hidden":"true"})})]}),Object(x.jsx)(q.a,{show:n,as:c.Fragment,leave:"transition ease-in duration-100",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:Object(x.jsx)(F.a.Options,{className:"absolute z-10 mt-1 w-full bg-white shadow-lg max-h-56 rounded-md py-1 text-base ring-1 ring-black ring-opacity-5 overflow-auto focus:outline-none sm:text-sm",children:o.map((function(e){return Object(x.jsx)(F.a.Option,{className:function(e){return H(e.active?"text-white bg-black":"text-gray-900","cursor-default select-none relative py-2 pl-3 pr-9")},value:e,children:function(t){var n=t.selected,c=t.active;return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("div",{className:"flex items-center",children:Object(x.jsx)("span",{className:H(n?"font-semibold":"font-normal","ml-3 block truncate"),children:e.meta.name})}),n?Object(x.jsx)("span",{className:H(c?"text-white":"text-black","absolute inset-y-0 right-0 flex items-center pr-4"),children:Object(x.jsx)(z.a,{className:"h-5 w-5","aria-hidden":"true"})}):null]})}},e.address)}))})})]})})}})]})}var W=function(){var e=Object(u.a)(l.a.mark((function e(t){var n,c,r,a,s,o,i,u,j,b;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.query.staking.nominators.keys(),t.query.staking.minNominatorBond(),t.query.staking.maxNominatorsCount(),t.query.staking.chillThreshold(),t.query.staking.currentEra()]);case 2:if(n=e.sent,c=Object(d.a)(n,5),r=c[0],a=c[1],s=c[2],o=c[3],i=c[4],u=r.map((function(e){return Object(d.a)(e.args,1)[0]})),j=o/100*s,b=u.length-j,!(u.length<j)){e.next=15;break}return console.log("You can't chill others when nominators (".concat(u.length,") is below threshold (").concat(j,")")),e.abrupt("return");case 15:return e.abrupt("return",{chillableAmount:b,nominatorIds:u,threshold:j,minNominatorBond:a,currentEra:i,maxNominatorsCount:s});case 16:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),R=function(e){var t=e.count,n=e.name,c=e.textColor;return Object(x.jsxs)("div",{children:[Object(x.jsx)("p",{className:"text-4xl pb-2 ",children:t}),Object(x.jsx)("p",{className:"text-lg text-"+c,children:n})]})},Y=function(e){var t=e.first,n=e.second;return Object(x.jsxs)("div",{className:"gap-8  bg-white border-white rounded-2xl mb-4 p-12 px-16 grid grid-cols-2",children:[Object(x.jsx)(R,Object(o.a)({},t)),Object(x.jsx)(R,Object(o.a)({},n))]})},G=function(e){var t=e.chillableAmount,n=(e.nominatorIds,e.threshold),c=e.minNominatorBond,r=(e.currentEra,e.maxNominatorsCount,e.isLoading);return Object(x.jsxs)("div",{className:"flex justify-between mb-8",children:[Object(x.jsx)(Y,{first:{name:"Threshold",count:r?"Loading":n,textColor:"red-500"}}),Object(x.jsx)("div",{}),Object(x.jsx)(Y,{first:{name:"Max Chillable Amount",count:r?"Loading":t,textColor:"yellow-500"}}),Object(x.jsx)("div",{}),Object(x.jsx)(Y,{first:{name:"Minimum Nominator Bond",count:r?"Loading":c.toHuman(),textColor:"blue-500"}})]})},Q=n.p+"static/media/kusamaLogo.445b5ac3.svg",V=n.p+"static/media/polkadotLogo.fbd6b0a6.svg",X=function(e){var t=e.network===v.POLKADOT?V:Q;return Object(x.jsx)("div",{className:"m-2",children:Object(x.jsx)("div",{className:"flex items-center",style:{width:"30px",height:"30px"},children:Object(x.jsx)("img",{src:t})})})},Z=function(){var e=Object(c.useContext)(P),t=e.selectedNetwork,n=e.setSelectedNetwork;v.POLKADOT;return Object(x.jsxs)("div",{className:"flex items-center ",children:[Object(x.jsx)(X,{network:v.KUSAMA}),Object(x.jsx)(S.a,{onColor:K.POLKADOT,offColor:K.KUSAMA,checked:t===v.POLKADOT,onChange:function(e){return n(e?v.POLKADOT:v.KUSAMA)},checkedIcon:!1,uncheckedIcon:!1}),Object(x.jsx)(X,{network:v.POLKADOT})]})},$=function(e){Object(j.a)(e);var t=Object(c.useState)([]),n=Object(d.a)(t,2),r=n[0],a=n[1],s=Object(c.useState)([]),i=Object(d.a)(s,2),b=i[0],h=i[1],f=Object(c.useState)(v.POLKADOT),p=Object(d.a)(f,2),g=p[0],w=p[1],N=Object(c.useState)({chillableAmount:0,nominatorIds:0,threshold:0,minNominatorBond:0,currentEra:0,maxNominatorsCount:0}),A=Object(d.a)(N,2),y=A[0],C=A[1],S=Object(c.useState)({address:null,meta:{name:null}}),K=Object(d.a)(S,2),L=K[0],E=K[1],B=Object(c.useState)(!0),F=Object(d.a)(B,2),q=F[0],z=F[1],H=Object(c.useState)(!0),R=Object(d.a)(H,2),Y=R[0],Q=R[1];Object(c.useEffect)((function(){V()}),[g]);var V=function(){var e=Object(u.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return z(!0),Q(!0),e.next=4,k(g);case 4:return t=e.sent,e.next=7,W(t);case 7:n=e.sent,U(t,n,X),C(n),Q(!1);case 11:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),X=function(e){e.sort((function(e,t){return e.amount>t.amount?1:-1})),a(e),z(!1)};return Object(x.jsx)(O.Provider,{value:{nominators:r,setNominators:a},children:Object(x.jsx)(m.Provider,{value:{selectedNominators:b,setSelectedNominators:h},children:Object(x.jsx)(T.Provider,{value:{statistics:y},children:Object(x.jsx)(D.Provider,{value:{selectedAccount:L},children:Object(x.jsx)(P.Provider,{value:{selectedNetwork:g,setSelectedNetwork:w},children:Object(x.jsxs)("div",{className:" p-24 h-screen",style:{backgroundColor:"#f5f3f1"},children:[Object(x.jsx)(Z,{selectedNetwork:g,setSelectedNetwork:w}),Object(x.jsxs)("div",{className:"flex justify-between items-start pb-6",children:[Object(x.jsx)("h1",{className:"text-4xl ",children:"dotsama-chill"}),Object(x.jsx)(J,{selectedAccount:L,setSelectedAccount:E})]}),Object(x.jsx)("p",{className:"text-md pb-6",children:"A tool to list nominators below threshold and has the option to chill multiple nominators in a batch."}),Object(x.jsx)(G,Object(o.a)(Object(o.a)({},y),{},{isLoading:Y})),q?Object(x.jsx)(M,{}):Object(x.jsx)(I,{})]})})})})})})};s.a.render(Object(x.jsx)($,{}),document.getElementById("root"))}},[[157,1,2]]]);
//# sourceMappingURL=main.0feec03e.chunk.js.map