(this["webpackJsonpdotsama-chill"]=this["webpackJsonpdotsama-chill"]||[]).push([[0],{120:function(e,t,n){},124:function(e,t){},134:function(e,t){},158:function(e,t,n){},162:function(e,t,n){"use strict";n.r(t);var r=n(0),c=n.n(r),a=n(88),s=n.n(a),o=(n(120),n(19)),i=n(12),l=n.n(i),u=n(13),d=n(2),b=n(52),j=n(8),m=c.a.createContext(null),x=n(9),h=function(e){var t=e.address,n=e.amount,c=e.idx,a=Object(r.useContext)(m),s=a.selectedNominators,o=a.setSelectedNominators,i=function(){return s.includes(t)};return Object(x.jsxs)("div",{className:"flex justify-between p-2 pr-4 border-gray-200 border items-center "+(c%2!==0?"bg-gray-100":"bg-white"),children:[Object(x.jsx)("input",{checked:i(),onChange:function(){o((function(e){return i()?e.filter((function(e){return e!==t})):[].concat(Object(j.a)(e),[t])}))},type:"checkbox",className:"w-1/12 text-left"}),Object(x.jsx)("div",{children:Object(x.jsx)("p",{className:"w-8/12 text-left self-center",children:"".concat(t.substring(0,5),"...").concat(t.substring(t.length-6,t.length-1))})}),Object(x.jsx)("p",{className:"mx-4 w-3/12 text-right",children:n})]})},f=c.a.createContext(null),O=function(e){var t=e.name,n=e.onClick,r=e.color,c=void 0===r?"#E6007A":r;return Object(x.jsx)("button",{style:{borderColor:c,backgroundColor:c},onClick:n,className:"h-full items-center border-2 py-2 px-6  h-fit text-lg text-white tracking-wider font-bold rounded-sm",children:t})},p=function(e){switch(e){case v.POLKADOT:return"wss://rpc.polkadot.io";default:throw Error("Unknown Provider ".concat(e))}},v=Object.freeze({POLKADOT:"POLKADOT"}),g=n(185),w=n(183),N=null,y=function(){var e=Object(u.a)(l.a.mark((function e(){var t,n,r,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===N){e.next=3;break}return console.log("used api instance from singleton"),e.abrupt("return",N);case 3:return t=p(v.POLKADOT),n=new g.a(t),e.next=7,w.a.create({provider:n});case 7:return r=e.sent,e.next=10,r.rpc.system.chain();case 10:return c=e.sent,console.log("Connected to node ".concat(c)),N=r,e.abrupt("return",N);case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),k=n(47),C=function(){var e=Object(u.a)(l.a.mark((function e(t,n,r){var c,a,s,o,i;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y();case 2:return c=e.sent,a=t.chillableAmount,s=r.map((function(e){return c.tx.staking.chillOther(e)})),r.length>a&&r.slice(0,a-1),e.next=8,Object(k.c)(n.meta.source);case 8:return o=e.sent,console.log("Total chillable:",s.length),console.log("Nominator"),console.log(r),console.log(s),i=c.tx.utility.batch(s),e.next=16,i.signAndSend(n.address,{signer:o.signer},(function(e){var t=e.status;t.isInBlock?console.log("\ud83d\udcc0 Transaction ".concat(i.meta.name," included at blockHash ").concat(t.asInBlock)):t.isBroadcast?console.log("\ud83d\ude80 Transaction broadcasted."):t.isFinalized?console.log("\ud83d\udcaf Transaction ".concat(i.meta.name,"(..) Finalized at blockHash ").concat(t.asFinalized)):t.isReady||console.log("\ud83e\udd37 Other status ".concat(t))}));case 16:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),A=n(99),S=n.n(A),B=function(e){Object(b.a)(e);var t=Object(r.useContext)(f).setNominators,n=Object.freeze({ASC:!1,DESC:!0}),c=Object(r.useState)(n.ASC),a=Object(d.a)(c,2),s=a[0],o=a[1];return Object(x.jsxs)("div",{className:"flex items-center ",children:[Object(x.jsx)("p",{className:"pr-2 ",children:"".concat(s===n.ASC?"ASC":"DESC")}),Object(x.jsx)(S.a,{onChange:function(e){o(e),t((function(t){var r=Object(j.a)(t);return e===n.ASC?r.sort((function(e,t){return e.amount>t.amount?1:-1})):r.sort((function(e,t){return e.amount<t.amount?1:-1})),r}))},onColor:"#E6007A",offColor:"#E6007A",checked:s,checkedIcon:!1,uncheckedIcon:!1})]})},P=(n(100),n(158),c.a.createContext(null)),T=c.a.createContext(null),E=function(){var e=Object(r.useContext)(f),t=e.nominators,n=(e.setNominators,Object(r.useContext)(m).selectedNominators),c=Object(r.useContext)(P).statistics,a=Object(r.useContext)(T).selectedAccount;return Object(x.jsxs)("div",{className:"text-lg",children:[Object(x.jsxs)("div",{className:"flex justify-between mb-2  p-4  bg-white items-center",children:[Object(x.jsxs)("p",{className:"text-2xl ",children:["Nominators (",t.length,")"]}),Object(x.jsxs)("div",{className:"flex justify-between items-center w-4/12 ",children:[Object(x.jsx)(B,{}),Object(x.jsx)(O,{onClick:function(){C(c,a,n)},name:"Chill ".concat(n.length)})]})]}),Object(x.jsxs)("div",{className:"flex items-center font-bold px-4 py-2 bg-white ",children:[Object(x.jsx)("p",{className:"w-1/12 text-left",children:"Wanna Chill ? "}),Object(x.jsx)("p",{className:"w-8/12",children:"Address"}),Object(x.jsx)("p",{className:"w-3/12 text-right  ",children:"Amount"})]})]})},D=function(){var e=Object(r.useContext)(m),t=(e.selectedNominators,e.setSelectedNominators),n=Object(r.useContext)(f).nominators;return Object(x.jsxs)("div",{className:"flex justify-between p-2 border-gray-200 border items-center bg-gray-100",children:[Object(x.jsx)("input",{onChange:function(e){return function(e){var r=e.target.checked;t((function(e){return r?Object(j.a)(n.map((function(e){return e.address}))):[]}))}(e)},type:"checkbox",className:"w-1/12 text-left"}),Object(x.jsx)("p",{className:"w-8/12 text-left self-center font-bold",children:"Chill all nominators"}),Object(x.jsx)("p",{className:"mx-4 w-3/12 text-right"})]})},I=function(){var e=Object(r.useContext)(f),t=e.nominators;e.onNominatorsFetched;return Object(x.jsxs)("div",{children:[Object(x.jsx)(E,{}),Object(x.jsx)(D,{}),t.map((function(e,t){return Object(r.createElement)(h,Object(o.a)(Object(o.a)({},e),{},{idx:t,key:e.address}))}))]})},F=function(){return Object(x.jsx)("p",{children:"Nominators are being loaded..."})},L=function(){var e=Object(u.a)(l.a.mark((function e(t,n,r){var c,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=n.nominatorIds,a=n.minNominatorBond,e.next=3,t.query.staking.bonded.multi(c).then(function(){var e=Object(u.a)(l.a.mark((function e(n){var c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return c=n.map((function(e){return e.unwrapOrDefault()})),e.next=3,t.query.staking.ledger.multi(c).then(function(){var e=Object(u.a)(l.a.mark((function e(t){var n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.map((function(e){return e.unwrapOrDefault()})).filter((function(e){return e.total.toBn()<a.toNumber()})).map((function(e){var t=e.stash,n=e.total;return{address:t.toHuman(),amount:n.toHuman()}})),r(n);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 3:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),q=n(184),z=n(186),H=n(73);function K(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.filter(Boolean).join(" ")}function J(e){var t=e.selectedAccount,n=e.setSelectedAccount,c=Object(r.useState)([]),a=Object(d.a)(c,2),s=a[0],o=a[1],i=Object(r.useState)(""),b=Object(d.a)(i,2),j=b[0],m=b[1],h=function(){var e=Object(u.a)(l.a.mark((function e(){var t;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(k.b)("dotsama-chill");case 2:return e.sent,e.next=5,Object(k.a)();case 5:t=e.sent,o(t),n(t[0]),O(t[0]);case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),f=function(){var e=Object(u.a)(l.a.mark((function e(t){return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n(t),O(t);case 2:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),O=function(){var e=Object(u.a)(l.a.mark((function e(t){var n,r,c;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y();case 2:return n=e.sent,e.next=5,n.query.system.account(t.address);case 5:r=e.sent,c=r.data.free,m(c.toHuman());case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(r.useEffect)((function(){h()}),[]),0===s.length?Object(x.jsx)("p",{children:"Please connect Polkadot.js Wallet"}):Object(x.jsxs)("div",{className:"flex items-center",children:[Object(x.jsx)("p",{className:"pr-4",children:j}),Object(x.jsx)(q.a,{value:t,onChange:f,children:function(e){var n=e.open;return Object(x.jsx)(x.Fragment,{children:Object(x.jsxs)("div",{className:"mt-1 relative pr-4",children:[Object(x.jsxs)(q.a.Button,{className:"relative w-full bg-white border border-gray-300 rounded-md shadow-sm pl-3 pr-10 py-2 text-left cursor-default focus:outline-none focus:ring-1 focus:ring-black focus:border-black sm:text-sm",children:[Object(x.jsx)("span",{className:"flex items-center",children:Object(x.jsx)("span",{className:"ml-3 block truncate",children:t.meta.name})}),Object(x.jsx)("span",{className:"ml-3 absolute inset-y-0 right-0 flex items-center pr-2 pointer-events-none",children:Object(x.jsx)(H.b,{className:"h-5 w-5 text-gray-400","aria-hidden":"true"})})]}),Object(x.jsx)(z.a,{show:n,as:r.Fragment,leave:"transition ease-in duration-100",leaveFrom:"opacity-100",leaveTo:"opacity-0",children:Object(x.jsx)(q.a.Options,{className:"absolute z-10 mt-1 w-full bg-white shadow-lg max-h-56 rounded-md py-1 text-base ring-1 ring-black ring-opacity-5 overflow-auto focus:outline-none sm:text-sm",children:s.map((function(e){return Object(x.jsx)(q.a.Option,{className:function(e){return K(e.active?"text-white bg-black":"text-gray-900","cursor-default select-none relative py-2 pl-3 pr-9")},value:e,children:function(t){var n=t.selected,r=t.active;return Object(x.jsxs)(x.Fragment,{children:[Object(x.jsx)("div",{className:"flex items-center",children:Object(x.jsx)("span",{className:K(n?"font-semibold":"font-normal","ml-3 block truncate"),children:e.meta.name})}),n?Object(x.jsx)("span",{className:K(r?"text-white":"text-black","absolute inset-y-0 right-0 flex items-center pr-4"),children:Object(x.jsx)(H.a,{className:"h-5 w-5","aria-hidden":"true"})}):null]})}},e.address)}))})})]})})}})]})}var W=function(){var e=Object(u.a)(l.a.mark((function e(t){var n,r,c,a,s,o,i,u,b;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all([t.query.staking.nominators.keys(),t.query.staking.minNominatorBond(),t.query.staking.maxNominatorsCount(),t.query.staking.chillThreshold()]);case 2:if(n=e.sent,r=Object(d.a)(n,4),c=r[0],a=r[1],s=r[2],o=r[3],i=c.map((function(e){return Object(d.a)(e.args,1)[0]})),u=o/100*s,b=i.length-u,!(i.length<u)){e.next=14;break}return console.log("You can't chill others when nominators (".concat(i.length,") is below threshold (").concat(u,")")),e.abrupt("return");case 14:return e.abrupt("return",{chillableAmount:b,nominatorIds:i,threshold:u,minNominatorBond:a});case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),M=function(e){var t=e.count,n=e.name,r=e.textColor;return Object(x.jsxs)("div",{children:[Object(x.jsx)("p",{className:"text-4xl pb-2 ",children:t}),Object(x.jsx)("p",{className:"text-lg text-"+r,children:n})]})},R=function(e){var t=e.first,n=e.second;return Object(x.jsxs)("div",{className:"gap-8  bg-white border-white rounded-2xl mb-4 p-12 px-16 grid grid-cols-2",children:[Object(x.jsx)(M,Object(o.a)({},t)),Object(x.jsx)(M,Object(o.a)({},n))]})},U=function(e){var t=e.chillableAmount,n=(e.nominatorIds,e.threshold),r=e.minNominatorBond;return Object(x.jsxs)("div",{className:"flex justify-between mb-8",children:[Object(x.jsx)(R,{first:{name:"Threshold",count:0===n?"Loading":n,textColor:"red-500"}}),Object(x.jsx)("div",{}),Object(x.jsx)(R,{first:{name:"Chillable Amount",count:0===t?"Loading":t,textColor:"yellow-500"}}),Object(x.jsx)("div",{}),Object(x.jsx)(R,{first:{name:"Minimum Nominator Bond",count:0===r?"Loading":r.toHuman(),textColor:"blue-500"}})]})},Y=function(e){Object(b.a)(e);var t=Object(r.useState)([]),n=Object(d.a)(t,2),c=n[0],a=n[1],s=Object(r.useState)([]),i=Object(d.a)(s,2),j=i[0],h=i[1],O=Object(r.useState)({chillableAmount:0,nominatorIds:0,threshold:0,minNominatorBond:0}),p=Object(d.a)(O,2),g=p[0],w=p[1],N=Object(r.useState)({address:null,meta:{name:null}}),k=Object(d.a)(N,2),C=k[0],A=k[1],S=Object(r.useState)(!0),B=Object(d.a)(S,2),E=B[0],D=B[1];Object(r.useEffect)((function(){q()}),[]);var q=function(){var e=Object(u.a)(l.a.mark((function e(){var t,n;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y(v.POLKADOT);case 2:return t=e.sent,e.next=5,W(t);case 5:n=e.sent,L(t,n,z),w(n);case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),z=function(e){e.sort((function(e,t){return e.amount>t.amount?1:-1})),a(e),D(!1)};return Object(x.jsx)(f.Provider,{value:{nominators:c,setNominators:a},children:Object(x.jsx)(m.Provider,{value:{selectedNominators:j,setSelectedNominators:h},children:Object(x.jsx)(P.Provider,{value:{statistics:g},children:Object(x.jsx)(T.Provider,{value:{selectedAccount:C},children:Object(x.jsxs)("div",{className:" p-24 h-screen",style:{backgroundColor:"#f5f3f1"},children:[Object(x.jsxs)("div",{className:"flex justify-between items-start pb-6",children:[Object(x.jsx)("h1",{className:"text-4xl ",children:"dotsama-chill"}),Object(x.jsx)(J,{selectedAccount:C,setSelectedAccount:A})]}),Object(x.jsx)("p",{className:"text-md pb-6",children:"A tool to list nominators below threshold and has the option to chill multiple nominators in a batch."}),Object(x.jsx)(U,Object(o.a)({},g)),E?Object(x.jsx)(F,{}):Object(x.jsx)(I,{})]})})})})})};s.a.render(Object(x.jsx)(Y,{}),document.getElementById("root"))}},[[162,1,2]]]);
//# sourceMappingURL=main.d6bbff9b.chunk.js.map